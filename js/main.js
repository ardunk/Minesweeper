$(function(){let s,c,i,n,d,f,a=!0,m,u,e=35,o,r=localStorage.getItem("difficulty")?localStorage.getItem("difficulty"):"beginner";function t(){$("#play-area").css("width",`${e*i}px`);for(let e=0;e<=c-1;e++)for(let t=0;t<=i-1;t++){var a=$("<div>",{class:"tile","data-row":e,"data-col":t});$("#play-area").append(a)}$("#mines").text(`${n}`),$("#minutes, #seconds").text("00")}function g(t){return 9<t?t:"0"+t}function l(){clearInterval(m),a=!0,$("#message, #new-record").hide(),$("#restart").addClass("disabled"),$("#play-area").empty(),t()}function h(t,e){s[t][e]<10&&($(`[data-row=${t}][data-col=${e}]`).addClass("open disabled"),0<s[t][e]&&(1===s[t][e]?$(`[data-row=${t}][data-col=${e}]`).css("color","darkblue"):2===s[t][e]?$(`[data-row=${t}][data-col=${e}]`).css("color","green"):3===s[t][e]?$(`[data-row=${t}][data-col=${e}]`).css("color","red"):$(`[data-row=${t}][data-col=${e}]`).css("color","darkviolet"),$(`[data-row=${t}][data-col=${e}]`).text(`${s[t][e]}`)),s[t][e]+=10,d++,d===c*i-n&&($("#message").css("color","green"),$("#message").text("You Won!").show(),w(),function(){(!localStorage.getItem(`${r}-record`)||localStorage.getItem(`${r}-record`)>u)&&(localStorage.setItem(`${r}-record`,u),$("#new-record").show());p()}()),10===s[t][e]&&(0!==t&&(h(t-1,e-1),h(t-1,e+1),h(t-1,e)),t!==c-1&&(h(t+1,e-1),h(t+1,e+1),h(t+1,e)),h(t,e-1),h(t,e+1)))}function w(){clearInterval(m),$(".tile").addClass("disabled"),$("#mines").text("0");for(let e=0;e<=c-1;e++)for(let t=0;t<=i-1;t++)s[e][t]%10==9&&$(`[data-row=${e}][data-col=${t}]`).addClass("open").text("*")}function p(){$(".records-list-item span").each(function(){localStorage.getItem(`${this.id}`)&&$(`#${this.id}`).text(g(parseInt(localStorage.getItem(`${this.id}`)/60,10))+":"+g(localStorage.getItem(`${this.id}`)%60))})}function x(t){switch(r=t,localStorage.setItem("difficulty",`${r}`),o=Math.floor($("body").width()/e),r){case"beginner":i=o<9?o:9,c=Math.floor(81/i),n=10;break;case"intermediate":i=o<16?o:16,c=Math.floor(256/i),n=40;break;case"expert":i=o<30?o:30,c=Math.floor(480/i),n=99}$(".difficulty-list-item").removeClass("disabled"),$(`#${r}`).addClass("disabled")}x(r),p(),t(),$("#wrapper").on("click","#message",function(){$("#message").hide()}),$("#play-area").on("click",".tile",function(){var t=$(this).data("row"),e=$(this).data("col");a&&(a=!1,function(t,e){let a,o,r=0,l;for(s=Array(c).fill().map(()=>Array(i).fill(0));r<n;)a=Math.floor(Math.random()*c),o=Math.floor(Math.random()*i),a===t&&o===e||9===s[a][o]||(s[a][o]=9,r++);for(a=0;a<=c-1;a++)for(o=0;o<=i-1;o++)9!==s[a][o]&&((l=0)!==a&&(9===s[a-1][o-1]&&l++,9===s[a-1][o+1]&&l++,9===s[a-1][o]&&l++),a!==c-1&&(9===s[a+1][o-1]&&l++,9===s[a+1][o+1]&&l++,9===s[a+1][o]&&l++),9===s[a][o-1]&&l++,9===s[a][o+1]&&l++,s[a][o]=l);u=0,d=0,f=0,m=setInterval(function(){$("#seconds").text(g(++u%60)),$("#minutes").text(g(parseInt(u/60,10)))},1e3),$("#restart").removeClass("disabled")}(t,e)),9===s[t][e]?($(this).css("background-color","red"),$("#message").css("color","red"),$("#message").text("You Lost").show(),w()):h(t,e)}),$("#play-area").contextmenu(function(t){t.preventDefault()}),$("#play-area").on("contextmenu",".tile",function(){var t,e;a||(t=$(this).data("row"),e=$(this).data("col"),t=t,e=e,s[t][e]<=9?(f++,s[t][e]+=20,$("#mines").text(`${n-f}`),$(`[data-row=${t}][data-col=${e}]`).text("`")):20<=s[t][e]&&(f--,s[t][e]-=20,$("#mines").text(`${n-f}`),$(`[data-row=${t}][data-col=${e}]`).text("")))}),$("#restart").click(function(){l()}),$("#beginner, #intermediate, #expert").click(function(){x(this.id),l(),$("#play-area")[0].scrollIntoView({behavior:"smooth"})}),$(window).resize(function(){location.reload()})});