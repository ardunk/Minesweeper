$(function(){let s,i,c,d,n,f,a=!0,m,u,e=35,o,r=$(window).width(),l=localStorage.getItem("difficulty")?localStorage.getItem("difficulty"):"beginner";function t(){$("#play-area").css("width",`${e*c}px`);for(let e=0;e<=i-1;e++)for(let t=0;t<=c-1;t++){var a=$("<div>",{class:"tile","data-row":e,"data-col":t});$("#play-area").append(a)}$("#mines").text(`${d}`),$("#minutes, #seconds").text("00")}function w(t){return 9<t?t:"0"+t}function h(){clearInterval(m),a=!0,$("#message, #new-record").hide(),$("#restart").addClass("disabled"),$("#play-area").empty(),t()}function g(t,e){s[t][e]<10&&($(`[data-row=${t}][data-col=${e}]`).addClass("open disabled"),0<s[t][e]&&(1===s[t][e]?$(`[data-row=${t}][data-col=${e}]`).css("color","darkblue"):2===s[t][e]?$(`[data-row=${t}][data-col=${e}]`).css("color","green"):3===s[t][e]?$(`[data-row=${t}][data-col=${e}]`).css("color","red"):$(`[data-row=${t}][data-col=${e}]`).css("color","darkviolet"),$(`[data-row=${t}][data-col=${e}]`).text(`${s[t][e]}`)),s[t][e]+=10,n++,n===i*c-d&&($("#message").css("color","green"),$("#message").text("You Won!").show(),p(),function(){(!localStorage.getItem(`${l}-record`)||localStorage.getItem(`${l}-record`)>u)&&(localStorage.setItem(`${l}-record`,u),$("#new-record").show());x()}()),10===s[t][e]&&(0!==t&&(g(t-1,e-1),g(t-1,e+1),g(t-1,e)),t!==i-1&&(g(t+1,e-1),g(t+1,e+1),g(t+1,e)),g(t,e-1),g(t,e+1)))}function p(){clearInterval(m),$(".tile").addClass("disabled"),$("#mines").text("0");for(let e=0;e<=i-1;e++)for(let t=0;t<=c-1;t++)s[e][t]%10==9&&$(`[data-row=${e}][data-col=${t}]`).addClass("open").text("*")}function x(){$(".records-list-item span").each(function(){localStorage.getItem(`${this.id}`)&&$(`#${this.id}`).text(w(parseInt(localStorage.getItem(`${this.id}`)/60,10))+":"+w(localStorage.getItem(`${this.id}`)%60))})}function I(t){switch(l=t,localStorage.setItem("difficulty",`${l}`),o=Math.floor(r/e),l){case"beginner":c=o<9?o:9,i=Math.floor(81/c),d=10;break;case"intermediate":c=o<16?o:16,i=Math.floor(256/c),d=40;break;case"expert":c=o<30?o:30,i=Math.floor(480/c),d=99}$(".difficulty-list-item").removeClass("disabled"),$(`#${l}`).addClass("disabled")}I(l),x(),t(),$("#wrapper").on("click","#message",function(){$("#message").hide()}),$("#play-area").on("click",".tile",function(){var t=$(this).data("row"),e=$(this).data("col");a&&(a=!1,function(t,e){let a,o,r=0,l;for(s=Array(i).fill().map(()=>Array(c).fill(0));r<d;)a=Math.floor(Math.random()*i),o=Math.floor(Math.random()*c),a===t&&o===e||9===s[a][o]||(s[a][o]=9,r++);for(a=0;a<=i-1;a++)for(o=0;o<=c-1;o++)9!==s[a][o]&&((l=0)!==a&&(9===s[a-1][o-1]&&l++,9===s[a-1][o+1]&&l++,9===s[a-1][o]&&l++),a!==i-1&&(9===s[a+1][o-1]&&l++,9===s[a+1][o+1]&&l++,9===s[a+1][o]&&l++),9===s[a][o-1]&&l++,9===s[a][o+1]&&l++,s[a][o]=l);u=0,n=0,f=0,m=setInterval(function(){$("#seconds").text(w(++u%60)),$("#minutes").text(w(parseInt(u/60,10)))},1e3),$("#restart").removeClass("disabled")}(t,e)),9===s[t][e]?($(this).css("background-color","red"),$("#message").css("color","red"),$("#message").text("You Lost").show(),p()):g(t,e)}),$("#play-area").contextmenu(function(t){t.preventDefault()}),$("#play-area").on("contextmenu",".tile",function(){var t,e;a||(t=$(this).data("row"),e=$(this).data("col"),t=t,e=e,s[t][e]<=9?(f++,s[t][e]+=20,$("#mines").text(`${d-f}`),$(`[data-row=${t}][data-col=${e}]`).text("`")):20<=s[t][e]&&(f--,s[t][e]-=20,$("#mines").text(`${d-f}`),$(`[data-row=${t}][data-col=${e}]`).text("")))}),$("#restart").click(function(){h()}),$("#beginner, #intermediate, #expert").click(function(){I(this.id),h(),$("#play-area")[0].scrollIntoView({behavior:"smooth"})}),$(window).resize(function(){$(window).width()!==r&&(location.reload(),width=$(window).width())})});